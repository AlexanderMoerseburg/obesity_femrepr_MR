#THIS SCRIPT EXECUTES AN ANALYSIS OF THREE STUDIES - SAIGE UKBB, FINNGEN, and Painter et al.
#THE RESULTS FOR EACH STUDY ARE STORED IN FILES :
# UKBB_SAIGE/PheCode_615_SAIGE_MACge20.txt.vcf.gz, 
# FINNGEN_R3/finngen_r3_N14_ENDOMETRIOSIS,
# Resources/Endometriosis_Zondervan/annotated_sumstats.txt

# TURN GENOMIC CONTROL ON BECAUSE THESE ARE GENOME-WIDE ANALYSES SO HAVE
# TO ACCOUNT FOR INFLATION
GENOMICCONTROL ON
AVERAGEFREQ ON

# === DESCRIBE AND PROCESS THE FIRST INPUT FILE ===
SEPARATOR TAB
MARKER ID
# NUMBER OF CASES
DEFAULT 4053
# IN SAIGE, ALT IS THE EFFECT ALLELE
ALLELE ALT REF
FREQ af
EFFECT beta
STDERR sebeta
PVAL pval 
PROCESS UKBB_SAIGE/PheCode_615_SAIGE_MACge20.txt.vcf.gz

# === DESCRIBE AND PROCESS THE SECOND INPUT FILE ===
SEPARATOR TAB
MARKER rsids
# NUMBER OF CASES
DEFAULT 4963
# IN FINNGEN, ALT IS THE EFFECT ALLELE
ALLELE alt ref
FREQ maf
EFFECT beta
STDERR sebeta
PVAL pval 
PROCESS FINNGEN_R3/finngen_r3_N14_ENDOMETRIOSIS

# === DESCRIBE AND PROCESS THE THIRD INPUT FILE ===
SEPARATOR TAB
MARKER rsid
# NUMBER OF CASES
DEFAULT 3194
# Allele B is the effect allele
ALLELE alleleB alleleA
FREQ all_maf
EFFECT beta
STDERR stderr
PVAL frequentist_add_pvalue 
PROCESS Resources/Endometriosis_Zondervan/annotated_sumstats.txt

# === ANALYSE FILES ===
OUTFILE meta_endometriosis_ .tbl
ANALYZE 

QUIT